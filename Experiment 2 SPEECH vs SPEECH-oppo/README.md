Experiment 1. SPEECH vs NOISE

## Table of Contents
1. [Repo directory structure](README.md#repo-directory-structure)
1. [Instructions](README.md#Instructions)

## Repo directory structure

This folder contains the raw data for experiment 2 (SPEECH vs SPEECH-oppo) as decripbed in the paper. 

    ├── README.md
    ├── pre_process_and_generate_data_for_R_exp2.m
    ├── exp1_LMEM_analysis.R
    ├── behavioral_vs_hemodynamic_responses_exp2.m
    ├── model only trace exp2
    ├── LMEM R data exp2
    ├── functions
    ├── fNIRS data exp2
    ├── behavioral data exp2
    ├── behavioral and hemodynamic responses data exp2

**pre_process_and_generate_data_for_R_exp2.m** is the preprocessing MATLAB script to process raw fNIRS recordings.

**exp2_LMEM_analysis.R** is the R script that takes in the pre-processed fNIRS recordings and fit a  LMEM to the recordings. 

**behavioral_vs_hemodynamic_responses_exp2.m** is the MATLAB script to fit and plot a linear model fitted to the vulnerability to masking (measured in behavioral d’) and hemodynamic responses (defined as HbO peak during task block). 

**model only trace exp2** folder has the fNIRS block average data across 14 listeners from 4 regions of interests (ROIs) under 2 conditions (SPEECH vs SPEECH-oppo)

**LMEM R data exp2** folder has the pre-processed fNIRS recordings to be fitted using LMEM. 

**Functions** folder contain the helper functions for data processing.

**fNIRS data exp2** folder contains the processed and unprocessed fNIRS recordings.

**behavioral data exp2** folder contains the behavioral responses recorded during experiment 2.

**behavioral and hemodynamic responses data exp1** folder contains the output from LMEM analysis. The paired vulnerability to masking (measured in behavioral d’) and hemodynamic responses (defined as HbO peak during task block) are stored in the folder for linear fitting using MATLAB later.

## Instructions

Preprocessed fNIRS data to be fitted with LMEM is stored in **LMEM R data exp2**.

Alternatively, those inputs can be regenerated by going through the preprocessing steps.

To begin preprocessing, run the MATLAB script **pre_process_and_generate_data_for_R_exp2.m**. It will call the helper functions and produce the data to be used in R for LMEM fit later.

To start LMEM analysis, run the R script **exp2_LMEM_analysis.R**. It will read the data generated from previous steps from the LMEM R data exp1 folder. This script will output the following:
1. The plot of LMEM model predicted data overlaid with raw recording as shown in Figure 2.
2. The percentage by which reference channel attributed to the total activation levels in the LMEM fits, as calculated via the area under the fitted curve with vs without β6 and β7.
3. LMEM predicted activation level defined as HbO peak during task block to be used later for linear fit using MATLAB .
4. LMEM fitting results as detailed in Table II.

To fit a linear model to the vulnerability to masking, measured in behavioral d’, and hemodynamic responses, defined as HbO peak during task block, run the MATLAB script **behavioral_vs_hemodynamic_responses_exp2.m**. It will fit a linear model to the data and generated plots as shown in figure 4.
